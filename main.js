/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => EditorPlaintextCalloutAppend
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  mySetting: "default"
};
var filetype = {
  "sh": "bash",
  "py": "python"
};
var reject_filetypes = ["md", "png", "jpg", "jpeg", "gif", "bmp", "svg", "mp3", "webm", "wav", "m4a", "ogg", "3gp", "flac", "mp4", "webm", "ogv", "pdf"];
var EditorPlaintextCalloutAppend = class extends import_obsidian.Plugin {
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  async onload() {
    await this.loadSettings();
    this.registerInterval(
      // TODO: is this the best process to do this? Is there a better way to register this (view change or something like that?)
      window.setInterval(() => this.embedPlaintextFiles(this.app, this.app.vault), 1e4)
    );
  }
  onunload() {
  }
  async obsidianUrl2FileContents(fileUrl, vault) {
    const fileTFile = await vault.getFileByPath(fileUrl);
    const fileContents = await vault.cachedRead(fileTFile);
    return fileContents;
  }
  async embedPlaintextFiles(app, vault) {
    let currentFile = app.workspace.getActiveFile();
    const currentFileContents = await vault.read(currentFile);
    let currentFileContents_split = currentFileContents.split("![[");
    let finalFileContents = currentFileContents_split[0];
    for (const item of currentFileContents_split.slice(1)) {
      let currentContent = item.split("]]\n");
      let skip = false;
      try {
        let otherFileContents = await this.obsidianUrl2FileContents(currentContent[0], vault);
        if (otherFileContents.contains("```") | reject_filetypes.contains(currentContent[0].split(".")[1])) {
          console.log("file (" + currentContent[0] + ") contains ``` or is a rejected filetype. Ignoring");
          finalFileContents += "![[" + currentContent[0] + "]]\n" + currentContent[1];
        } else {
          if (currentContent[1].slice(0, 8) == "\n---\n```") {
            let filePrintout = currentContent[1].split("\n---\n```");
            filePrintout = filePrintout[1].split("\n```\n---\n");
            currentContent[1] = filePrintout[1];
          }
          if (!reject_filetypes.contains(currentContent[0].split(".")[1])) {
            console.log("file (" + currentContent[0] + ") is being added.");
            if (Object.keys(filetype).includes(currentContent[0].split(".")[1])) {
              finalFileContents += "![[" + currentContent[0] + "]]\n\n---\n```" + filetype[currentContent[0].split(".")[1]] + "\n" + otherFileContents + "\n```\n---\n" + currentContent[1];
            } else {
              finalFileContents += "![[" + currentContent[0] + "]]\n\n---\n```" + currentContent[0].split(".")[1] + "\n" + otherFileContents + "\n```\n---\n" + currentContent[1];
            }
          } else {
            console.log("skipping .md file" + currentContent[0]);
            finalFileContents += "![[" + currentContent[0] + "]]\n\n" + currentContent[1];
          }
        }
      } catch (e) {
        console.log("failed to add file (" + currentContent[0] + "). Not found.");
        finalFileContents += "![[" + currentContent[0] + "]]\n" + currentContent[1];
      }
    }
    console.log("\nfinal contents:");
    console.log(finalFileContents);
    app.vault.modify(currentFile, finalFileContents);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBFZGl0b3IsIE1hcmtkb3duVmlldywgTW9kYWwsIE5vdGljZSwgUGx1Z2luLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG4vLyBSZW1lbWJlciB0byByZW5hbWUgdGhlc2UgY2xhc3NlcyBhbmQgaW50ZXJmYWNlcyFcblxuaW50ZXJmYWNlIEVkaXRvclBsYWludGV4dENhbGxvdXRBcHBlbmRTZXR0aW5ncyB7XG5cdG15U2V0dGluZzogc3RyaW5nO1xufVxuXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBFZGl0b3JQbGFpbnRleHRDYWxsb3V0QXBwZW5kU2V0dGluZ3MgPSB7XG5cdG15U2V0dGluZzogJ2RlZmF1bHQnXG59XG5cbmNvbnN0IGZpbGV0eXBlOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuXHRcInNoXCI6IFwiYmFzaFwiLFxuXHRcInB5XCI6IFwicHl0aG9uXCIsXG59O1xuXG5jb25zdCByZWplY3RfZmlsZXR5cGVzID0gW1wibWRcIixcInBuZ1wiLFwianBnXCIsXCJqcGVnXCIsXCJnaWZcIixcImJtcFwiLFwic3ZnXCIsXCJtcDNcIixcIndlYm1cIixcIndhdlwiLFwibTRhXCIsXCJvZ2dcIixcIjNncFwiLFwiZmxhY1wiLFwibXA0XCIsXCJ3ZWJtXCIsXCJvZ3ZcIixcInBkZlwiXTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRWRpdG9yUGxhaW50ZXh0Q2FsbG91dEFwcGVuZCBleHRlbmRzIFBsdWdpbiB7XG5cdHNldHRpbmdzOiBFZGl0b3JQbGFpbnRleHRDYWxsb3V0QXBwZW5kU2V0dGluZ3M7XG5cblx0YXN5bmMgbG9hZFNldHRpbmdzKCkge1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuXHR9XG5cblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG5cdH1cblxuXHRhc3luYyBvbmxvYWQoKSB7XG5cdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblxuXG5cdFx0dGhpcy5yZWdpc3RlckludGVydmFsKCAvLyBUT0RPOiBpcyB0aGlzIHRoZSBiZXN0IHByb2Nlc3MgdG8gZG8gdGhpcz8gSXMgdGhlcmUgYSBiZXR0ZXIgd2F5IHRvIHJlZ2lzdGVyIHRoaXMgKHZpZXcgY2hhbmdlIG9yIHNvbWV0aGluZyBsaWtlIHRoYXQ/KVxuXHRcdFx0d2luZG93LnNldEludGVydmFsKCgpID0+IHRoaXMuZW1iZWRQbGFpbnRleHRGaWxlcyh0aGlzLmFwcCx0aGlzLmFwcC52YXVsdCksIDEwMDAwKVxuXHRcdCk7XG5cblxuXHRcdC8vIFRoaXMgd2FzIGFuIGF0dGVtcHQgYXQgcmV2aXNpbmcgdGhlIG1hcmtkb3duIHRvIGVtYmVkIGEgcGxhaW50ZXh0IGZpbGUgYnkgcmVnaXN0ZXJpbmcgYSBwb3N0IHByb2Nlc3NvclxuXHQgICAgLy8gUHJvYmxlbTogaW4gdGhlIG1hcmtkb3duIHBvc3QgcHJvY2Vzc29yIEkgY2FuJ3QgZG8gZGVsYXlzIG9yIHdhaXQgZm9yIGFzeW5jIG9wZXJhdGlvbnMgb24gYW4gZXh0ZXJuYWwgZnVuY3Rpb24gc28gaXQganVzdCByZWNlaXZlcyBhIHBlbmRpbmcgcHJvbWlzZSBub3QgdGhlIHN0cmluZyBpdHNlbGYuIEkgY2FuIGV2ZW4gbG9nIHRvIHRoZSBjb25zb2xlIHRoZSBzdHJpbmcgSSByZWNlaXZlIGluIHRoZSBmdW5jdGlvbiBidXQgdGhlIG1hcmtkb3duIGl0c2VsZiB3aWxsIGp1c3QgZ2V0IHRoZSBQcm9taXNlIG5vdCB5ZXQgcmVzb2x2aW5nIHRoZSBmaWxlIGNvbnRlbnRzIGZvciBtZS5cblx0ICAgIC8vIHJlZjogaHR0cHM6Ly9kb2NzLm9ic2lkaWFuLm1kL1BsdWdpbnMvRWRpdG9yL01hcmtkb3duK3Bvc3QrcHJvY2Vzc2luZ1xuXHRcdC8vdGhpcy5yZWdpc3Rlck1hcmtkb3duUG9zdFByb2Nlc3NvcigoZWxlbWVudCwgY29udGV4dCkgPT4ge1xuXHRcdC8vXHRjb25zdCBjb2RlYmxvY2tzID0gZWxlbWVudC5maW5kQWxsKFwiY29kZVwiKTtcblxuXHRcdC8vXHRmb3IgKGxldCBjb2RlYmxvY2sgb2YgY29kZWJsb2Nrcykge1xuXHRcdC8vXHRcdGNvbnN0IHsgIHZhdWx0ICB9ID0gdGhpcy5hcHA7XG5cdFx0Ly9cdFx0dmF1bHQucHJvY2Vzcy5cblxuXHRcdC8vXHRcdC8vY29uc29sZS5sb2coY29kZWJsb2NrLmlubmVyVGV4dC50cmltKCkpO1xuXG5cdFx0Ly9cdFx0Ly9jb25zdCBmaWxlQ29udGVudHM6IHN0cmluZ1tdID0gYXdhaXQgUHJvbWlzZS5hbGwoXG5cdFx0Ly9cdFx0Ly9cdHZhdWx0LmdldE1hcmtkb3duRmlsZXMoKS5tYXAoKGNvZGVibG9jay5pbm5lclRleHQudHJpbSgpKSA9PiB2YXVsdC5jYWNoZWRSZWFkKCkpXG5cdFx0Ly9cdFx0Ly8pO1xuXG5cdFx0Ly9cdFx0Ly9jb25zb2xlLmxvZyh2YXVsdC5jYWNoZWRSZWFkKGNvZGVibG9jay5pbm5lclRleHQudHJpbSgpKSk7XG5cdFx0Ly9cdCAgICAvL2NvbnN0IG15RmlsZSA9IFwib2JzaWRpYW46Ly9vcGVuP3ZhdWx0PXRlc3RfdmF1bHQmZmlsZT1jcmVhdGVfcGx1Z2luJTJGUHJvY2Vzc1wiO1xuXHRcdC8vXHQgICAgY29uc3QgbXlGaWxlID0gXCJjcmVhdGVfcGx1Z2luL3Rlc3Quc2hcIjtcblx0XHQvL1x0ICAgIGNvbnN0IG15RmlsZXMgPSB2YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG5cdFx0Ly9cdCAgICAvL2NvbnNvbGUubG9nKG15RmlsZXMpO1xuXHRcdC8vXHRcdC8vY29uc29sZS5sb2coY29kZWJsb2NrLmdldFRleHQoKSk7XG5cdFx0Ly9cdFx0Ly9jb25zb2xlLmxvZyhteUZpbGUpO1xuXHRcdC8vXHQgICAgLy9jb2RlYmxvY2sucmVwbGFjZVdpdGgodmF1bHQuY2FjaGVkUmVhZChjb2RlYmxvY2suaW5uZXJUZXh0LnRyaW0oKSkpO1xuXHRcdC8vXHRcdGNvbnN0IG15RmlsZTEgPSB2YXVsdC5nZXRGaWxlQnlQYXRoKFwib2JzaWRpYW46Ly9vcGVuP3ZhdWx0PXRlc3RfdmF1bHQmZmlsZT1jcmVhdGVfcGx1Z2luJTJGUHJvY2Vzc1wiKTtcblxuXHRcdC8vXHRcdGNvbnN0IG15VmFyID10aGlzLm9ic2lkaWFuVXJsMkZpbGVDb250ZW50cyhteUZpbGUsdmF1bHQpO1xuXHRcdC8vXHRcdGNvbnNvbGUubG9nKFwiYmVmb3JlXCIpO1xuXHRcdC8vXHRcdHNsZWVwKDUwMDApO1xuXHRcdC8vXHRcdGNvbnNvbGUubG9nKFwiYWZ0ZXJcIik7XG5cdFx0Ly9cdFx0Y29uc29sZS5sb2cobXlWYXIpO1xuXHRcdC8vXHRcdGNvZGVibG9jay5yZXBsYWNlV2l0aCh2YXVsdC5yZWFkKHZhdWx0LmdldEZpbGVCeVBhdGgobXlGaWxlKSkpO1xuXHRcdC8vXHRcdC8vY29kZWJsb2NrLnJlcGxhY2VXaXRoKFwiSGVsbG9cIik7XG5cdFx0Ly9cdFx0XHQvL3RoaXMub2JzaWRpYW5VcmwyRmlsZUNvbnRlbnRzKG15RmlsZSx2YXVsdCkpO1xuXHRcdC8vXHRcdC8vY29kZWJsb2NrLnJlcGxhY2VXaXRoKHZhdWx0LmNhY2hlZFJlYWQoY29kZWJsb2NrLmlubmVyVGV4dC50cmltKCkpKTtcblx0XHQvL1x0XHQvL2NvZGVibG9jay5yZXBsYWNlV2l0aChcImhlbGxvXCIpO1xuXG5cdFx0Ly9cdFx0Ly9jb25zdCB0ZXh0ID0gY29kZWJsb2NrLmlubmVyVGV4dC50cmltKCk7XG5cdFx0Ly9cdFx0Ly9uZXcgTm90aWNlKHRleHQpO1xuXHRcdC8vXHRcdC8vaWYgKHRleHRbMF0gPT09IFwiOlwiICYmIHRleHRbdGV4dC5sZW5ndGggLSAxXSA9PT0gXCI6XCIpIHtcblx0XHQvL1x0XHQvL1x0Y29uc3QgZW1vamlFbCA9IGNvZGVibG9jay5jcmVhdGVTcGFuKHtcblx0XHQvL1x0XHQvL1x0XHR0ZXh0OiBBTExfRU1PSklTW3RleHRdID8/IHRleHQsXG5cblx0XHQvL1x0XHQvL1x0fSk7XG5cdFx0Ly9cdFx0Ly9cdGNvZGVibG9jay5yZXBsYWNlV2l0aChlbW9qaUVsKTtcblx0XHQvL1x0XHQvL31cblx0XHQvL1x0fVxuXHRcdC8vfSk7XG5cblxuXG5cdFx0LyoqXG5cdFx0ICogQWZ0ZXIgdGhpcyBpbiB0aGUgb25sb2FkIG1ldGhvZCBpcyB0aGUgZGVmYXVsdCBleGFtcGxlIGNvZGUgcmV0YWluZWQgZm9yIHJlZlxuXHRcdCAqL1xuXG5cdFx0Ly8vLyBBZGQgcmliYm9uIGljb24gdGhhdCBnZW5lcmF0ZXMgbm90aWNlXG5cdFx0Ly90aGlzLmFkZFJpYmJvbkljb24oJ2RpY2UnLFxuXHRcdC8vXHRcdCdHcmVldCcsICgpID0+IHtcblx0XHQvL1x0XHRuZXcgTm90aWNlKCdIZWxsbyBXb3JsZCEnKTtcblx0XHQvL30pO1xuXG5cdFx0Ly8vLyBUaGlzIGNyZWF0ZXMgYW4gaWNvbiBpbiB0aGUgbGVmdCByaWJib24uIENsaWNraW5nIGl0IHdpbGwgcG9wIHVwIGEgbm90aWNlXG5cdFx0Ly9jb25zdCByaWJib25JY29uRWwgPSB0aGlzLmFkZFJpYmJvbkljb24oJ2RpY2UnLCAnU2FtcGxlIFBsdWdpbicsIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcblx0XHQvL1x0Ly8gQ2FsbGVkIHdoZW4gdGhlIHVzZXIgY2xpY2tzIHRoZSBpY29uLlxuXHRcdC8vXHRuZXcgTm90aWNlKCdUaGlzIGlzIGEgbm90aWNlIScpO1xuXHRcdC8vfSk7XG5cblxuXG5cdFx0Ly8vLyBQZXJmb3JtIGFkZGl0aW9uYWwgdGhpbmdzIHdpdGggdGhlIHJpYmJvblxuXHRcdC8vcmliYm9uSWNvbkVsLmFkZENsYXNzKCdteS1wbHVnaW4tcmliYm9uLWNsYXNzJyk7XG5cblx0XHQvLy8vIFRoaXMgYWRkcyBhIHN0YXR1cyBiYXIgaXRlbSB0byB0aGUgYm90dG9tIG9mIHRoZSBhcHAuIERvZXMgbm90IHdvcmsgb24gbW9iaWxlIGFwcHMuXG5cdFx0Ly9jb25zdCBzdGF0dXNCYXJJdGVtRWwgPSB0aGlzLmFkZFN0YXR1c0Jhckl0ZW0oKTtcblx0XHQvL3N0YXR1c0Jhckl0ZW1FbC5zZXRUZXh0KCdTdGF0dXMgQmFyIFRleHQnKTtcblxuXHRcdC8vLy8gVGhpcyBhZGRzIGEgc2ltcGxlIGNvbW1hbmQgdGhhdCBjYW4gYmUgdHJpZ2dlcmVkIGFueXdoZXJlXG5cdFx0Ly90aGlzLmFkZENvbW1hbmQoe1xuXHRcdC8vXHRpZDogJ29wZW4tc2FtcGxlLW1vZGFsLXNpbXBsZScsXG5cdFx0Ly9cdG5hbWU6ICdPcGVuIHNhbXBsZSBtb2RhbCAoc2ltcGxlKScsXG5cdFx0Ly9cdGNhbGxiYWNrOiAoKSA9PiB7XG5cdFx0Ly9cdFx0bmV3IFNhbXBsZU1vZGFsKHRoaXMuYXBwKS5vcGVuKCk7XG5cdFx0Ly9cdH1cblx0XHQvL30pO1xuXHRcdC8vLy8gVGhpcyBhZGRzIGFuIGVkaXRvciBjb21tYW5kIHRoYXQgY2FuIHBlcmZvcm0gc29tZSBvcGVyYXRpb24gb24gdGhlIGN1cnJlbnQgZWRpdG9yIGluc3RhbmNlXG5cdFx0Ly90aGlzLmFkZENvbW1hbmQoe1xuXHRcdC8vXHRpZDogJ3NhbXBsZS1lZGl0b3ItY29tbWFuZCcsXG5cdFx0Ly9cdG5hbWU6ICdTYW1wbGUgZWRpdG9yIGNvbW1hbmQnLFxuXHRcdC8vXHRlZGl0b3JDYWxsYmFjazogKGVkaXRvcjogRWRpdG9yLCB2aWV3OiBNYXJrZG93blZpZXcpID0+IHtcblx0XHQvL1x0XHRjb25zb2xlLmxvZyhlZGl0b3IuZ2V0U2VsZWN0aW9uKCkpO1xuXHRcdC8vXHRcdGVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKCdTYW1wbGUgRWRpdG9yIENvbW1hbmQnKTtcblx0XHQvL1x0fVxuXHRcdC8vfSk7XG5cdFx0Ly8vLyBUaGlzIGFkZHMgYSBjb21wbGV4IGNvbW1hbmQgdGhhdCBjYW4gY2hlY2sgd2hldGhlciB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgYXBwIGFsbG93cyBleGVjdXRpb24gb2YgdGhlIGNvbW1hbmRcblx0XHQvL3RoaXMuYWRkQ29tbWFuZCh7XG5cdFx0Ly9cdGlkOiAnb3Blbi1zYW1wbGUtbW9kYWwtY29tcGxleCcsXG5cdFx0Ly9cdG5hbWU6ICdPcGVuIHNhbXBsZSBtb2RhbCAoY29tcGxleCknLFxuXHRcdC8vXHRjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4pID0+IHtcblx0XHQvL1x0XHQvLyBDb25kaXRpb25zIHRvIGNoZWNrXG5cdFx0Ly9cdFx0Y29uc3QgbWFya2Rvd25WaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0XHQvL1x0XHRpZiAobWFya2Rvd25WaWV3KSB7XG5cdFx0Ly9cdFx0XHQvLyBJZiBjaGVja2luZyBpcyB0cnVlLCB3ZSdyZSBzaW1wbHkgXCJjaGVja2luZ1wiIGlmIHRoZSBjb21tYW5kIGNhbiBiZSBydW4uXG5cdFx0Ly9cdFx0XHQvLyBJZiBjaGVja2luZyBpcyBmYWxzZSwgdGhlbiB3ZSB3YW50IHRvIGFjdHVhbGx5IHBlcmZvcm0gdGhlIG9wZXJhdGlvbi5cblx0XHQvL1x0XHRcdGlmICghY2hlY2tpbmcpIHtcblx0XHQvL1x0XHRcdFx0bmV3IFNhbXBsZU1vZGFsKHRoaXMuYXBwKS5vcGVuKCk7XG5cdFx0Ly9cdFx0XHR9XG5cblx0XHQvL1x0XHRcdC8vIFRoaXMgY29tbWFuZCB3aWxsIG9ubHkgc2hvdyB1cCBpbiBDb21tYW5kIFBhbGV0dGUgd2hlbiB0aGUgY2hlY2sgZnVuY3Rpb24gcmV0dXJucyB0cnVlXG5cdFx0Ly9cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHQvL1x0XHR9XG5cdFx0Ly9cdH1cblx0XHQvL30pO1xuXG5cdFx0Ly8vLyBUaGlzIGFkZHMgYSBzZXR0aW5ncyB0YWIgc28gdGhlIHVzZXIgY2FuIGNvbmZpZ3VyZSB2YXJpb3VzIGFzcGVjdHMgb2YgdGhlIHBsdWdpblxuXHRcdC8vdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBTYW1wbGVTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG5cblx0XHQvLy8vIElmIHRoZSBwbHVnaW4gaG9va3MgdXAgYW55IGdsb2JhbCBET00gZXZlbnRzIChvbiBwYXJ0cyBvZiB0aGUgYXBwIHRoYXQgZG9lc24ndCBiZWxvbmcgdG8gdGhpcyBwbHVnaW4pXG5cdFx0Ly8vLyBVc2luZyB0aGlzIGZ1bmN0aW9uIHdpbGwgYXV0b21hdGljYWxseSByZW1vdmUgdGhlIGV2ZW50IGxpc3RlbmVyIHdoZW4gdGhpcyBwbHVnaW4gaXMgZGlzYWJsZWQuXG5cdFx0Ly90aGlzLnJlZ2lzdGVyRG9tRXZlbnQoZG9jdW1lbnQsICdjbGljaycsIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcblx0XHQvL1x0Y29uc29sZS5sb2coJ2NsaWNrJywgZXZ0KTtcblx0XHQvL30pO1xuXG5cdFx0Ly8vLyBJZiB0aGUgcGx1Z2luIGhvb2tzIHVwIGFueSBnbG9iYWwgRE9NIGV2ZW50cyAob24gcGFydHMgb2YgdGhlIGFwcCB0aGF0IGRvZXNuJ3QgYmVsb25nIHRvIHRoaXMgcGx1Z2luKVxuXHRcdC8vLy8gVXNpbmcgdGhpcyBmdW5jdGlvbiB3aWxsIGF1dG9tYXRpY2FsbHkgcmVtb3ZlIHRoZSBldmVudCBsaXN0ZW5lciB3aGVuIHRoaXMgcGx1Z2luIGlzIGRpc2FibGVkLlxuXHRcdC8vdGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCAnY2xpY2snLCAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0Ly9cdGNvbnNvbGUubG9nKCdjbGljaycsIGV2dCk7XG5cdFx0Ly99KTtcblxuXHRcdC8vLy8gV2hlbiByZWdpc3RlcmluZyBpbnRlcnZhbHMsIHRoaXMgZnVuY3Rpb24gd2lsbCBhdXRvbWF0aWNhbGx5IGNsZWFyIHRoZSBpbnRlcnZhbCB3aGVuIHRoZSBwbHVnaW4gaXMgZGlzYWJsZWQuXG5cdFx0Ly90aGlzLnJlZ2lzdGVySW50ZXJ2YWwod2luZG93LnNldEludGVydmFsKCgpID0+IGNvbnNvbGUubG9nKCdzZXRJbnRlcnZhbCcpLCA1ICogNjAgKiAxMDAwKSk7XG5cblx0XHQvLy8vIE1ha2UgYSBwZXJpb2RpYyBub3RpY2Vcblx0XHQvL3RoaXMucmVnaXN0ZXJJbnRlcnZhbCh3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4gbmV3IE5vdGljZSgnSGVsbG8gV29ybGQhJykpKTtcblx0fVxuXG5cdG9udW5sb2FkKCkge1xuXG5cdH1cblxuXG5cblx0YXN5bmMgb2JzaWRpYW5VcmwyRmlsZUNvbnRlbnRzKGZpbGVVcmw6IHN0cmluZywgdmF1bHQ6IFZhdWx0KTogc3RyaW5ne1xuXHRcdGNvbnN0IGZpbGVURmlsZSA9IGF3YWl0IHZhdWx0LmdldEZpbGVCeVBhdGgoZmlsZVVybCk7XG5cdFx0Y29uc3QgZmlsZUNvbnRlbnRzID0gYXdhaXQgdmF1bHQuY2FjaGVkUmVhZChmaWxlVEZpbGUpO1xuXHRcdC8vY29uc29sZS5sb2coZmlsZUNvbnRlbnRzKTtcblx0XHRyZXR1cm4gZmlsZUNvbnRlbnRzO1xuXHR9XG5cblx0YXN5bmMgZW1iZWRQbGFpbnRleHRGaWxlcyhhcHA6IEFwcCwgdmF1bHQ6IFZhdWx0KSB7XG5cdFx0LyoqXG5cdFx0ICFbW2ZpbGVuYW1lXV1cblx0XHQgLS0tXG5cdFx0IGBgYGZpbGV0eXBlXG5cdFx0IGNvbnRlbnRcblx0XHQgYGBgXG5cdFx0IC0tLVxuXG5cdFx0ICovXG5cdFx0Ly9jb25zb2xlLmxvZyhcIlxcblxcblxcblxcbnN0YXJ0aW5nXCIpO1xuXHRcdGxldCBjdXJyZW50RmlsZSA9IGFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpXG5cdFx0Y29uc3QgY3VycmVudEZpbGVDb250ZW50cyA9IGF3YWl0IHZhdWx0LnJlYWQoY3VycmVudEZpbGUpOyAvLyBoYWQgdGhpcyBjYWNoZWRSZWFkIGJ1dCByZXZpc2VkIHRvIGhvcGVmdWxseSBpbXByb3ZlIG5vdCBvdmVycmlkaW5nIGZpbGUgY2hhbmdlcy5cblx0XHQvL2NvbnNvbGUubG9nKFwiXFxuY3VycmVudCBjb250ZW50czpcIik7XG5cdFx0Ly9jb25zb2xlLmxvZyhjdXJyZW50RmlsZUNvbnRlbnRzKTtcblx0XHRsZXQgY3VycmVudEZpbGVDb250ZW50c19zcGxpdCA9IGN1cnJlbnRGaWxlQ29udGVudHMuc3BsaXQoXCIhW1tcIik7XG5cdFx0bGV0IGZpbmFsRmlsZUNvbnRlbnRzID0gY3VycmVudEZpbGVDb250ZW50c19zcGxpdFswXTtcblx0XHRmb3IgKGNvbnN0IGl0ZW0gb2YgY3VycmVudEZpbGVDb250ZW50c19zcGxpdC5zbGljZSgxKSl7XG5cdFx0XHQvL2NvbnNvbGUubG9nKFwiaXRlbTogXFxuXCIraXRlbSk7XG5cdFx0XHRsZXQgY3VycmVudENvbnRlbnQgPSBpdGVtLnNwbGl0KFwiXV1cXG5cIik7XG5cdFx0XHRsZXQgc2tpcCA9IGZhbHNlO1xuXHRcdFx0Ly9jb25zb2xlLmxvZyhjdXJyZW50Q29udGVudFswXSk7XG5cblx0XHRcdHRyeXtcblx0XHRcdFx0bGV0IG90aGVyRmlsZUNvbnRlbnRzID0gYXdhaXQgdGhpcy5vYnNpZGlhblVybDJGaWxlQ29udGVudHMoY3VycmVudENvbnRlbnRbMF0sdmF1bHQpO1xuXG5cdFx0XHRcdGlmICgob3RoZXJGaWxlQ29udGVudHMuY29udGFpbnMoXCJgYGBcIikpIHwgKHJlamVjdF9maWxldHlwZXMuY29udGFpbnMoY3VycmVudENvbnRlbnRbMF0uc3BsaXQoJy4nKVsxXSkpICl7XG5cdFx0XHRcdFx0Y29uc29sZS5sb2coXCJmaWxlIChcIitjdXJyZW50Q29udGVudFswXStcIikgY29udGFpbnMgYGBgIG9yIGlzIGEgcmVqZWN0ZWQgZmlsZXR5cGUuIElnbm9yaW5nXCIpO1xuXHRcdFx0XHRcdGZpbmFsRmlsZUNvbnRlbnRzKz1cIiFbW1wiK2N1cnJlbnRDb250ZW50WzBdK1wiXV1cXG5cIitjdXJyZW50Q29udGVudFsxXTtcblx0XHRcdFx0fSBlbHNle1xuXG5cdFx0XHRcdFx0Ly8gY2hlY2sgaWYgdGhlcmUgaXMgYSBmaWxlIHByaW50b3V0IGFmdGVyLiBpZiBzbywgcmVtb3ZlIGl0XG5cdFx0XHRcdFx0Ly9jb25zb2xlLmxvZyhcImN1cnJlbnQgY29udGVudDogXCIpO1xuXHRcdFx0XHRcdC8vY29uc29sZS5sb2coY3VycmVudENvbnRlbnRbMV0uc2xpY2UoMCwxMCkpO1xuXHRcdFx0XHRcdGlmIChjdXJyZW50Q29udGVudFsxXS5zbGljZSgwLDgpID09IFwiXFxuLS0tXFxuYGBgXCIpe1xuXHRcdFx0XHRcdFx0bGV0IGZpbGVQcmludG91dCA9IGN1cnJlbnRDb250ZW50WzFdLnNwbGl0KFwiXFxuLS0tXFxuYGBgXCIpO1xuXHRcdFx0XHRcdFx0ZmlsZVByaW50b3V0ID0gZmlsZVByaW50b3V0WzFdLnNwbGl0KFwiXFxuYGBgXFxuLS0tXFxuXCIpO1xuXHRcdFx0XHRcdFx0Y3VycmVudENvbnRlbnRbMV0gPWZpbGVQcmludG91dFsxXTtcblx0XHRcdFx0XHR9XG5cblxuXHRcdFx0XHRcdC8vIGFkZCB0aGUgY29udGVudHMgYmFja1xuXHRcdFx0XHRcdGlmICghcmVqZWN0X2ZpbGV0eXBlcy5jb250YWlucyhjdXJyZW50Q29udGVudFswXS5zcGxpdCgnLicpWzFdKSl7XG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhcImZpbGUgKFwiK2N1cnJlbnRDb250ZW50WzBdK1wiKSBpcyBiZWluZyBhZGRlZC5cIilcblx0XHRcdFx0XHRcdGlmIChPYmplY3Qua2V5cyhmaWxldHlwZSkuaW5jbHVkZXMoY3VycmVudENvbnRlbnRbMF0uc3BsaXQoJy4nKVsxXSkpe1xuXHRcdFx0XHRcdFx0XHRmaW5hbEZpbGVDb250ZW50cys9XCIhW1tcIitjdXJyZW50Q29udGVudFswXStcIl1dXFxuXFxuLS0tXFxuYGBgXCIrZmlsZXR5cGVbY3VycmVudENvbnRlbnRbMF0uc3BsaXQoJy4nKVsxXV0rXCJcXG5cIitvdGhlckZpbGVDb250ZW50cytcIlxcbmBgYFxcbi0tLVxcblwiK2N1cnJlbnRDb250ZW50WzFdO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0ZmluYWxGaWxlQ29udGVudHMrPVwiIVtbXCIrY3VycmVudENvbnRlbnRbMF0rXCJdXVxcblxcbi0tLVxcbmBgYFwiK2N1cnJlbnRDb250ZW50WzBdLnNwbGl0KCcuJylbMV0rXCJcXG5cIitvdGhlckZpbGVDb250ZW50cytcIlxcbmBgYFxcbi0tLVxcblwiK2N1cnJlbnRDb250ZW50WzFdO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvL2ZpbmFsRmlsZUNvbnRlbnRzKz1jdXJyZW50Q29udGVudFswXStjdXJyZW50Q29udGVudFsxXStcIlxcbi0tLVxcbmBgYFwiK2N1cnJlbnRDb250ZW50WzBdLnNwbGl0KCcuJylbMV0rXCJcXG5gYGBcXG4tLS1cXG5cIjtcblxuXHRcdFx0XHRcdFx0Ly9jb25zb2xlLmxvZyhcImNvbnRlbnRzOiBcXG5cIitvdGhlckZpbGVDb250ZW50cyk7XG5cdFx0XHRcdFx0fWVsc2V7XG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhcInNraXBwaW5nIC5tZCBmaWxlXCIrY3VycmVudENvbnRlbnRbMF0pO1xuXHRcdFx0XHRcdFx0ZmluYWxGaWxlQ29udGVudHMrPVwiIVtbXCIrY3VycmVudENvbnRlbnRbMF0rXCJdXVxcblxcblwiK2N1cnJlbnRDb250ZW50WzFdO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSBjYXRjaCB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKFwiZmFpbGVkIHRvIGFkZCBmaWxlIChcIitjdXJyZW50Q29udGVudFswXStcIikuIE5vdCBmb3VuZC5cIik7XG5cdFx0XHRcdGZpbmFsRmlsZUNvbnRlbnRzKz1cIiFbW1wiK2N1cnJlbnRDb250ZW50WzBdK1wiXV1cXG5cIitjdXJyZW50Q29udGVudFsxXTtcblx0XHRcdH1cblx0XHR9XG5cdFx0Y29uc29sZS5sb2coXCJcXG5maW5hbCBjb250ZW50czpcIik7XG5cdFx0Y29uc29sZS5sb2coZmluYWxGaWxlQ29udGVudHMpO1xuXG5cblx0XHRhcHAudmF1bHQubW9kaWZ5KGN1cnJlbnRGaWxlLGZpbmFsRmlsZUNvbnRlbnRzKTtcblx0fVxufVxuXG5jbGFzcyBTYW1wbGVNb2RhbCBleHRlbmRzIE1vZGFsIHtcblx0Y29uc3RydWN0b3IoYXBwOiBBcHApIHtcblx0XHRzdXBlcihhcHApO1xuXHR9XG5cblx0b25PcGVuKCkge1xuXHRcdGNvbnN0IHtjb250ZW50RWx9ID0gdGhpcztcblx0XHRjb250ZW50RWwuc2V0VGV4dCgnV29haCEnKTtcblx0fVxuXG5cdG9uQ2xvc2UoKSB7XG5cdFx0Y29uc3Qge2NvbnRlbnRFbH0gPSB0aGlzO1xuXHRcdGNvbnRlbnRFbC5lbXB0eSgpO1xuXHR9XG59XG5cbmNsYXNzIFNhbXBsZVNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcblx0cGx1Z2luOiBFZGl0b3JQbGFpbnRleHRDYWxsb3V0QXBwZW5kO1xuXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IEVkaXRvclBsYWludGV4dENhbGxvdXRBcHBlbmQpIHtcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdH1cblxuXHRkaXNwbGF5KCk6IHZvaWQge1xuXHRcdGNvbnN0IHtjb250YWluZXJFbH0gPSB0aGlzO1xuXG5cdFx0Y29udGFpbmVyRWwuZW1wdHkoKTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoJ1NldHRpbmcgIzEnKVxuXHRcdFx0LnNldERlc2MoJ0l0XFwncyBhIHNlY3JldCcpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdFbnRlciB5b3VyIHNlY3JldCcpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5teVNldHRpbmcpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5teVNldHRpbmcgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXHR9XG59XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsc0JBQTRGO0FBUTVGLElBQU0sbUJBQXlEO0FBQUEsRUFDOUQsV0FBVztBQUNaO0FBRUEsSUFBTSxXQUFtQztBQUFBLEVBQ3hDLE1BQU07QUFBQSxFQUNOLE1BQU07QUFDUDtBQUVBLElBQU0sbUJBQW1CLENBQUMsTUFBSyxPQUFNLE9BQU0sUUFBTyxPQUFNLE9BQU0sT0FBTSxPQUFNLFFBQU8sT0FBTSxPQUFNLE9BQU0sT0FBTSxRQUFPLE9BQU0sUUFBTyxPQUFNLEtBQUs7QUFFeEksSUFBcUIsK0JBQXJCLGNBQTBELHVCQUFPO0FBQUEsRUFHaEUsTUFBTSxlQUFlO0FBQ3BCLFNBQUssV0FBVyxPQUFPLE9BQU8sQ0FBQyxHQUFHLGtCQUFrQixNQUFNLEtBQUssU0FBUyxDQUFDO0FBQUEsRUFDMUU7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQUNwQixVQUFNLEtBQUssU0FBUyxLQUFLLFFBQVE7QUFBQSxFQUNsQztBQUFBLEVBRUEsTUFBTSxTQUFTO0FBQ2QsVUFBTSxLQUFLLGFBQWE7QUFHeEIsU0FBSztBQUFBO0FBQUEsTUFDSixPQUFPLFlBQVksTUFBTSxLQUFLLG9CQUFvQixLQUFLLEtBQUksS0FBSyxJQUFJLEtBQUssR0FBRyxHQUFLO0FBQUEsSUFDbEY7QUFBQSxFQXdJRDtBQUFBLEVBRUEsV0FBVztBQUFBLEVBRVg7QUFBQSxFQUlBLE1BQU0seUJBQXlCLFNBQWlCLE9BQXFCO0FBQ3BFLFVBQU0sWUFBWSxNQUFNLE1BQU0sY0FBYyxPQUFPO0FBQ25ELFVBQU0sZUFBZSxNQUFNLE1BQU0sV0FBVyxTQUFTO0FBRXJELFdBQU87QUFBQSxFQUNSO0FBQUEsRUFFQSxNQUFNLG9CQUFvQixLQUFVLE9BQWM7QUFXakQsUUFBSSxjQUFjLElBQUksVUFBVSxjQUFjO0FBQzlDLFVBQU0sc0JBQXNCLE1BQU0sTUFBTSxLQUFLLFdBQVc7QUFHeEQsUUFBSSw0QkFBNEIsb0JBQW9CLE1BQU0sS0FBSztBQUMvRCxRQUFJLG9CQUFvQiwwQkFBMEIsQ0FBQztBQUNuRCxlQUFXLFFBQVEsMEJBQTBCLE1BQU0sQ0FBQyxHQUFFO0FBRXJELFVBQUksaUJBQWlCLEtBQUssTUFBTSxNQUFNO0FBQ3RDLFVBQUksT0FBTztBQUdYLFVBQUc7QUFDRixZQUFJLG9CQUFvQixNQUFNLEtBQUsseUJBQXlCLGVBQWUsQ0FBQyxHQUFFLEtBQUs7QUFFbkYsWUFBSyxrQkFBa0IsU0FBUyxLQUFLLElBQU0saUJBQWlCLFNBQVMsZUFBZSxDQUFDLEVBQUUsTUFBTSxHQUFHLEVBQUUsQ0FBQyxDQUFDLEdBQUk7QUFDdkcsa0JBQVEsSUFBSSxXQUFTLGVBQWUsQ0FBQyxJQUFFLG9EQUFvRDtBQUMzRiwrQkFBbUIsUUFBTSxlQUFlLENBQUMsSUFBRSxTQUFPLGVBQWUsQ0FBQztBQUFBLFFBQ25FLE9BQU07QUFLTCxjQUFJLGVBQWUsQ0FBQyxFQUFFLE1BQU0sR0FBRSxDQUFDLEtBQUssY0FBYTtBQUNoRCxnQkFBSSxlQUFlLGVBQWUsQ0FBQyxFQUFFLE1BQU0sWUFBWTtBQUN2RCwyQkFBZSxhQUFhLENBQUMsRUFBRSxNQUFNLGNBQWM7QUFDbkQsMkJBQWUsQ0FBQyxJQUFHLGFBQWEsQ0FBQztBQUFBLFVBQ2xDO0FBSUEsY0FBSSxDQUFDLGlCQUFpQixTQUFTLGVBQWUsQ0FBQyxFQUFFLE1BQU0sR0FBRyxFQUFFLENBQUMsQ0FBQyxHQUFFO0FBQy9ELG9CQUFRLElBQUksV0FBUyxlQUFlLENBQUMsSUFBRSxtQkFBbUI7QUFDMUQsZ0JBQUksT0FBTyxLQUFLLFFBQVEsRUFBRSxTQUFTLGVBQWUsQ0FBQyxFQUFFLE1BQU0sR0FBRyxFQUFFLENBQUMsQ0FBQyxHQUFFO0FBQ25FLG1DQUFtQixRQUFNLGVBQWUsQ0FBQyxJQUFFLG1CQUFpQixTQUFTLGVBQWUsQ0FBQyxFQUFFLE1BQU0sR0FBRyxFQUFFLENBQUMsQ0FBQyxJQUFFLE9BQUssb0JBQWtCLGlCQUFlLGVBQWUsQ0FBQztBQUFBLFlBQzdKLE9BQU87QUFDTixtQ0FBbUIsUUFBTSxlQUFlLENBQUMsSUFBRSxtQkFBaUIsZUFBZSxDQUFDLEVBQUUsTUFBTSxHQUFHLEVBQUUsQ0FBQyxJQUFFLE9BQUssb0JBQWtCLGlCQUFlLGVBQWUsQ0FBQztBQUFBLFlBQ25KO0FBQUEsVUFLRCxPQUFLO0FBQ0osb0JBQVEsSUFBSSxzQkFBb0IsZUFBZSxDQUFDLENBQUM7QUFDakQsaUNBQW1CLFFBQU0sZUFBZSxDQUFDLElBQUUsV0FBUyxlQUFlLENBQUM7QUFBQSxVQUNyRTtBQUFBLFFBQ0Q7QUFBQSxNQUNELFNBQVEsR0FBTjtBQUNELGdCQUFRLElBQUkseUJBQXVCLGVBQWUsQ0FBQyxJQUFFLGVBQWU7QUFDcEUsNkJBQW1CLFFBQU0sZUFBZSxDQUFDLElBQUUsU0FBTyxlQUFlLENBQUM7QUFBQSxNQUNuRTtBQUFBLElBQ0Q7QUFDQSxZQUFRLElBQUksbUJBQW1CO0FBQy9CLFlBQVEsSUFBSSxpQkFBaUI7QUFHN0IsUUFBSSxNQUFNLE9BQU8sYUFBWSxpQkFBaUI7QUFBQSxFQUMvQztBQUNEOyIsCiAgIm5hbWVzIjogW10KfQo=
